seed_everything: 80085

trainer:
  accelerator: gpu
  devices: 1
  max_epochs: 400  # ✅ CHANGED: High ceiling (was 50)
  accumulate_grad_batches: 8
  gradient_clip_val: 0.5
  check_val_every_n_epoch: 1  # ✅ KEPT: Essential for early stopping
  log_every_n_steps: 5
  
  callbacks:
    # Learning rate monitoring
    - class_path: LearningRateMonitor
      init_args:
        logging_interval: step
    
    # ✅ ADDED: Early stopping for fair comparison
    - class_path: EarlyStopping
      init_args:
        monitor: val_center
        patience: 15
        mode: min
        min_delta: 0.001
        verbose: true
        strict: true
    
    # ✅ MODIFIED: Model checkpoint saves best model
    - class_path: ModelCheckpoint
      init_args:
        monitor: val_center
        mode: min
        save_last: true
        save_top_k: 1  # ✅ CHANGED: Only best model (was 5)
        filename: "best-{epoch:02d}-{val_center:.4f}"  # ✅ CHANGED: Better naming
        auto_insert_metric_name: false
